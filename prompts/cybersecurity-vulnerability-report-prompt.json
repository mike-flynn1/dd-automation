{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "id": "cybersecurity-vulnerability-report",
  "name": "cybersecurity_vulnerability_report_generator",
  "description": "Generates a comprehensive cybersecurity vulnerability report in HTML format using DefectDojo MCP server data",
  "version": "1.0.0",
  "mcp_compatibility": {
    "server_type": "defectdojo",
    "required_tools": ["get_findings", "get_products", "get_engagements"],
    "data_sources": ["findings", "products", "test_results"]
  },
  "defectdojo_queries": {
    "findings": {
      "filter": "active=true",
      "products": ["SBIR DTK", "OnePASS"],
      "severity_mapping": {
        "cat1": ["Critical", "High"],
        "cat2": ["Medium"],
        "cat3": ["Low"]
      },
      "time_windows": {
        "cat1_recent": "30_days",
        "cat2_recent": "180_days"
      }
    },
    "products": {
      "names": ["SBIR DTK", "OnePASS"],
      "include_metadata": true,
      "repository_tracking": true
    }
  },
  "prompt_template": {
    "system_prompt": "You are generating a cybersecurity vulnerability report using data from DefectDojo MCP server. Use the provided DefectDojo findings data to populate all dynamic sections while preserving static content exactly as specified.",
    "structure": {
      "header": {
        "logo": {
          "position": "center-aligned",
          "source": "/templates/static/bamtech-logo.png",
          "description": "Company logo at top of page"
        }
      },
      "title": {
        "text": "Cybersecurity Vulnerability Report",
        "alignment": "center"
      },
      "subtitle": {
        "content": "Current date in format: Month Day, Year",
        "example": "October 29, 2025",
        "placement": "under title"
      },
      "sections": [
        {
          "name": "Introduction",
          "type": "static_text",
          "content": "The following information is a comprehensive overview of the Cybersecurity posture for SBIR DTK and OnePASS.",
          "editable": false
        },
        {
          "name": "Vulnerabilities",
          "type": "data_table",
          "description": "Table containing vulnerability statistics",
          "required_fields": [
            {
              "field": "total_cat1_findings",
              "description": "Total Unmitigated CAT I findings (both High and Critical)"
            },
            {
              "field": "cat1_last_30_days",
              "description": "Unmitigated CAT I findings (High and Critical) over the last 30 days only"
            },
            {
              "field": "total_cat2_findings",
              "description": "Total Unmitigated CAT II findings (Medium and Moderate severity)"
            },
            {
              "field": "cat2_last_180_days",
              "description": "Unmitigated CAT II findings (Medium and Moderate severity) over the last 180 days only"
            },
            {
              "field": "total_cat3_findings",
              "description": "Total Raw CAT III findings (Low severity)"
            }
          ]
        },
        {
          "name": "Remediation Process",
          "type": "static_text",
          "content": "All open High and Medium items are evaluated to ensure they are true findings. Once they are identified as valid issues, they are prioritized in the scrum team's product backlog according to severity. Any items that cannot be fixed within the given SLA timeframe will be clearly communicated with the government and PO&AM'd. All findings open longer than 30 days will be carried over to quarterly Information Security POA&M.",
          "editable": false
        },
        {
          "name": "Monthly Asset Discovery Results",
          "type": "dynamic_text",
          "description": "Repository count and delta information",
          "required_data": [
            {
              "field": "total_repositories",
              "description": "Total number of repositories"
            },
            {
              "field": "repositories_added_30_days",
              "description": "Number of repositories added in the last 30 days"
            }
          ],
          "format_template": "{total_repositories} total repositories with {repositories_added_30_days} added in the last 30 days."
        },
        {
          "name": "Point of Contact",
          "type": "static_text",
          "content": "BAM Technologies is the official point of contact for resolving application vulnerabilities. Any vulnerabilities that result from A1 VDC-owned infrastructure must be resolved by the managed service provider.",
          "editable": false
        },
        {
          "name": "Resource Update",
          "type": "static_text",
          "content": "There are no purchase requirements and no manpower shifts required at this time.",
          "editable": false
        }
      ]
    }
  },
  "input_parameters": {
    "report_date": {
      "type": "string",
      "format": "MMMM DD, YYYY",
      "description": "Date for the report subtitle",
      "required": true
    },
    "vulnerability_data": {
      "type": "object",
      "properties": {
        "total_cat1_findings": {"type": "integer", "minimum": 0},
        "cat1_last_30_days": {"type": "integer", "minimum": 0},
        "total_cat2_findings": {"type": "integer", "minimum": 0},
        "cat2_last_180_days": {"type": "integer", "minimum": 0},
        "total_cat3_findings": {"type": "integer", "minimum": 0}
      },
      "required": ["total_cat1_findings", "cat1_last_30_days", "total_cat2_findings", "cat2_last_180_days", "total_cat3_findings"]
    },
    "repository_data": {
      "type": "object",
      "properties": {
        "total_repositories": {"type": "integer", "minimum": 0},
        "repositories_added_30_days": {"type": "integer", "minimum": 0}
      },
      "required": ["total_repositories", "repositories_added_30_days"]
    }
  },
  "output_format": "HTML",
  "styling_requirements": [
    "Professional appearance suitable for executive reporting",
    "Clear table formatting for vulnerability data",
    "Consistent heading hierarchy",
    "Center-aligned logo and title"
  ]
}